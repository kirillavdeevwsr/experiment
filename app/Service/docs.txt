# Интеграция с [прилоением, получающем данные из базы 1сКолледж](1c.sequencia.ru)

###Обозначения:
$link = http://1c.sequencia.ru
$token = токен, полученный приавторизации с *1c.sequencia* (см пункт Авторизация).
$student_ref_key = уникальный ключ студента, который приходит в ответе при авторизации студента.

###Любой сеанс начинается с авторизации.
Все ответы приходят в **json-формате**.

##Авторизация.
С сайта оправляется запрос по адресу: **$link**/api/auth?login=login&password=password.
Где 'login' => 'Агарков О.В.', 'password' => 'qzwxec123'.
В ответ приходит объект {'token': 'некий тонен'}. По нему в дальнейшем можно отправлять запросы. Время жизни токена - 15 минут.


##Получения данных пользователя
С сайта отправяется запрос по адресу: **$link**/api/user/?token=**$token**&login=login&password=password.
Где 'token' => **$token***, a 'login' и 'password' получаются со страницы авторизации пользователей.
В ответ приходит объект с полями, если пользователь преподаватель:
{  "ind_key": ""
  "login": ""
  "password": ""
  "additional": {
    "fullname": ""
    "birthday": ""
    "phone": ""
    "email": ""
    "address": ""
    "isStudent": false
  }
}
Если студент(например):
{
  "ind_key": ""
  "login": "stud2016000101"
  "password": ""
  "additional": {
    "fullname": "Ахметшина  Илюза  Ирековна "
    "birthday": "1998-12-16T00:00:00"
    "specialty": "Земельно-имущественные отношения"
    "group": {
      "name": "4 ЗИО С-2015"
      "status": "Учится"
      "financing": "Коммерческое"
    }
    "phone": null
    "email": null
    "address": null
    "student_ref_key": ""
    "isStudent": true
  }
}

Если пользователся с данным логин и пароль не существует в базе 1с, приходит ответ null.

##Получение шаблона расписания на семестр.
Данные приходят по запросу $link/api/schedule/?token=**$token**  с сайта.
Пример расписания на семестр.



##Получения замены в расписании на следующий день.
Данные в 1с заполняются ежедневно в 18.00. С 1c.sequencia данные получаются по запросу $link/api/dschedule?date=YYYY-MM-DD  (формат даты Год-месяц-день).
Формат данных.




##Получение оценок.
Дапнные выводятся на 1 месяц. Получаются по запросу $link/api/rating?token=**$token**&student_ref_key=**$student_ref_key**&period=YYYY-MM.
Пример данных.
  0 => {#307 ▼
    +"date": "12.01.2018"
    +"rate": 0
    +"presence": true
    +"type": ""
    +"discipline": {#301 ▼
      +"shortName": "История"
      +"fullName": "История"
    }